/**
 * string-left-right
 * Looks up the first non-whitespace character to the left/right of a given index
 * Version: 4.0.8
 * Author: Roy Revelt, Codsen Ltd
 * License: MIT
 * Homepage: https://codsen.com/os/string-left-right/
 */

import t from"lodash.isplainobject";import e from"lodash.clonedeep";const n="4.0.8";function r(t){const e={value:t,hungry:!1,optional:!1};return(e.value.endsWith("?*")||e.value.endsWith("*?"))&&e.value.length>2?(e.value=e.value.slice(0,e.value.length-2),e.optional=!0,e.hungry=!0):e.value.endsWith("?")&&e.value.length>1?(e.value=e.value.slice(0,~-e.value.length),e.optional=!0):e.value.endsWith("*")&&e.value.length>1&&(e.value=e.value.slice(0,~-e.value.length),e.hungry=!0),e}function i(t){return"number"==typeof t}function l(t){return"string"==typeof t}function o({str:t,idx:e=0,stopAtNewlines:n=!1,stopAtRawNbsp:r=!1}){if("string"!=typeof t||!t.length)return null;if(e&&"number"==typeof e||(e=0),!t[e+1])return null;if(t[e+1]&&(t[e+1].trim()||n&&"\n\r".includes(t[e+1])||r&&" "===t[e+1]))return e+1;if(t[e+2]&&(t[e+2].trim()||n&&"\n\r".includes(t[e+2])||r&&" "===t[e+2]))return e+2;for(let i=e+1,l=t.length;i<l;i++)if(t[i].trim()||n&&"\n\r".includes(t[i])||r&&" "===t[i])return i;return null}function u(t,e=0){return o({str:t,idx:e,stopAtNewlines:!1,stopAtRawNbsp:!1})}function s(t,e){return o({str:t,idx:e,stopAtNewlines:!0,stopAtRawNbsp:!1})}function f(t,e){return o({str:t,idx:e,stopAtNewlines:!1,stopAtRawNbsp:!0})}function d({str:t,idx:e,stopAtNewlines:n,stopAtRawNbsp:r}){if("string"!=typeof t||!t.length)return null;if(e&&"number"==typeof e||(e=0),e<1)return null;if(t[~-e]&&(t[~-e].trim()||n&&"\n\r".includes(t[~-e])||r&&" "===t[~-e]))return~-e;if(t[e-2]&&(t[e-2].trim()||n&&"\n\r".includes(t[e-2])||r&&" "===t[e-2]))return e-2;for(let i=e;i--;)if(t[i]&&(t[i].trim()||n&&"\n\r".includes(t[i])||r&&" "===t[i]))return i;return null}function h(t,e=0){return d({str:t,idx:e,stopAtNewlines:!1,stopAtRawNbsp:!1})}function c(t,e){return d({str:t,idx:e,stopAtNewlines:!0,stopAtRawNbsp:!1})}function g(t,e){return d({str:t,idx:e,stopAtNewlines:!1,stopAtRawNbsp:!0})}function m(t,e,n,i,o){if("string"!=typeof e||!e.length)return null;if("number"!=typeof n&&(n=0),"right"===t&&!e[n+1]||"left"===t&&!e[~-n])return null;let s=n;const f=[];let d,c,g,m=0;for(;m<o.length;){if(!l(o[m])||!o[m].length){m+=1;continue}const{value:n,optional:p,hungry:a}=r(o[m]),w="right"===t?u(e,s):h(e,s);if(!(i.i&&e[w].toLowerCase()===n.toLowerCase()||!i.i&&e[w]===n)){if(p){m+=1;continue}if(g){m+=1,g=void 0;continue}return null}{const r="right"===t?u(e,w):h(e,w);a&&(i.i&&e[r].toLowerCase()===n.toLowerCase()||!i.i&&e[r]===n)?g=!0:m+=1,"number"==typeof w&&"right"===t&&w>s+1?f.push([s+1,w]):"left"===t&&"number"==typeof w&&w<~-s&&f.unshift([w+1,s]),s=w,"right"===t?(void 0===d&&(d=w),c=w):(void 0===c&&(c=w),d=w)}}return void 0===d||void 0===c?null:{gaps:f,leftmostChar:d,rightmostChar:c}}const p={i:!1};function a(e,n,...r){if(!r||!r.length)throw new Error("string-left-right/leftSeq(): only two input arguments were passed! Did you intend to use left() method instead?");let i;return i=t(r[0])?{...p,...r.shift()}:p,m("left",e,n,i,Array.from(r).reverse())}function w(e,n,...r){if(!r||!r.length)throw new Error("string-left-right/rightSeq(): only two input arguments were passed! Did you intend to use right() method instead?");let i;return i=t(r[0])?{...p,...r.shift()}:p,m("right",e,n,i,r)}function y(t,e,n,r,i=[]){if("string"!=typeof e||!e.length)return null;if(n&&"number"==typeof n||(n=0),"right"===t&&!e[n+1]||"left"===t&&0==+n)return null;let l=null,o=null;do{l="right"===t?w(e,"number"==typeof o?o:n,...i):a(e,"number"==typeof o?o:n,...i),null!==l&&(o="right"===t?l.rightmostChar:l.leftmostChar)}while(l);if(null!=o&&"right"===t&&(o+=1),null===o)return null;if("right"===t){if(e[o]&&e[o].trim())return o;const t=u(e,o);if(r&&0!==r.mode){if(1===r.mode)return o;if(2===r.mode){const t=e.slice(o);if(t.trim()||t.includes("\n")||t.includes("\r"))for(let t=o,n=e.length;t<n;t++)if(e[t].trim()||"\n\r".includes(e[t]))return t;return e.length}}else{if(t===o+1)return o;if(!(e.slice(o,t||e.length).trim()||e.slice(o,t||e.length).includes("\n")||e.slice(o,t||e.length).includes("\r")))return t?~-t:e.length;for(let t=o,n=e.length;t<n;t++)if("\n\r".includes(e[t]))return t}return t||e.length}if(e[o]&&e[~-o]&&e[~-o].trim())return o;const s=h(e,o);if(!r||0===r.mode){if(s===o-2)return o;if(e.slice(0,o).trim()||e.slice(0,o).includes("\n")||e.slice(0,o).includes("\r"))for(let t=o;t--;)if("\n\r".includes(e[t])||e[t].trim())return t+1+(e[t].trim()?1:0);return 0}if(1===r.mode)return o;if(2===r.mode){const t=e.slice(0,o);if(t.trim()||t.includes("\n")||t.includes("\r"))for(let t=o;t--;)if(e[t].trim()||"\n\r".includes(e[t]))return t+1;return 0}return null!==s?s+1:0}function v(n,r,...o){if(!o.length||1===o.length&&t(o[0]))return null;const u={mode:0};if(t(o[0])){const t={...u,...e(o[0])};if(t.mode){if(l(t.mode)&&"0123".includes(t.mode))t.mode=Number.parseInt(t.mode,10);else if(!i(t.mode))throw new Error(`string-left-right/chompLeft(): [THROW_ID_01] the opts.mode is wrong! It should be 0, 1, 2 or 3. It was given as ${t.mode} (type ${typeof t.mode})`)}else t.mode=0;return y("left",n,r,t,e(o).slice(1))}return l(o[0])?y("left",n,r,u,e(o)):y("left",n,r,u,e(o).slice(1))}function b(n,r,...o){if(!o.length||1===o.length&&t(o[0]))return null;const u={mode:0};if(t(o[0])){const t={...u,...e(o[0])};if(t.mode){if(l(t.mode)&&"0123".includes(t.mode))t.mode=Number.parseInt(t.mode,10);else if(!i(t.mode))throw new Error(`string-left-right/chompRight(): [THROW_ID_02] the opts.mode is wrong! It should be 0, 1, 2 or 3. It was given as ${t.mode} (type ${typeof t.mode})`)}else t.mode=0;return y("right",n,r,t,e(o).slice(1))}return l(o[0])?y("right",n,r,u,e(o)):y("right",n,r,u,e(o).slice(1))}export{v as chompLeft,b as chompRight,h as left,a as leftSeq,c as leftStopAtNewLines,g as leftStopAtRawNbsp,u as right,w as rightSeq,s as rightStopAtNewLines,f as rightStopAtRawNbsp,n as version};
